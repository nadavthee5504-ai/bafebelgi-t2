<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>×•×•×¤×œ ×‘×œ×’×™ ×¢×œ ××§×œ | ×”×–×× ×”</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://fonts.googleapis.com/css2?family=Heebo:wght@300;500;700&display=swap" rel="stylesheet">

  <style>
    :root{
      --waffle-color:#ff9f47;
      --waffle-bg:#fff4e4;
      --main-font:'Heebo',sans-serif;
      --dark-brown:#4a2c1b;
    }

    body{
      font-family:var(--main-font);
      background:#ffe9d1;
      margin:0;
      padding:0;
      direction:rtl;
    }

    .box{
      max-width:600px;
      margin:20px auto;
      background:#fff;
      padding:30px;
      border-radius:20px;
      box-shadow:0 5px 15px rgba(0,0,0,.1);
    }

    .title{
      font-size:36px;
      font-weight:700;
      text-align:center;
      margin:20px 0 10px;
      color:var(--dark-brown);
    }

    .price{
      text-align:center;
      font-size:20px;
      margin-bottom:15px;
      color:#884a22;
    }

    .phone-link-container{text-align:center;margin-bottom:25px;}
    .phone-link{
      color:var(--dark-brown);
      font-weight:700;
      text-decoration:none;
      border:1px solid var(--waffle-color);
      padding:8px 15px;
      border-radius:8px;
      background:#fff3e6;
      display:inline-block;
      transition:.2s;
    }
    .phone-link:hover{background:var(--waffle-color);color:#fff;}

    label{font-weight:700;margin-top:20px;display:block;color:#333;}
    input:not([type="radio"]):not([type="checkbox"]), textarea{
      width:100%;
      padding:12px;
      margin-top:5px;
      border-radius:8px;
      border:1px solid #ddd;
      box-sizing:border-box;
      transition:border-color .3s;
    }
    input:focus, textarea:focus{
      border-color:var(--waffle-color);
      outline:none;
    }
    input[type="time"]{max-width:150px;}

    .waffle-box{
      background:var(--waffle-bg);
      padding:18px;
      border-radius:12px;
      margin-top:20px;
      border:1px solid #ff9f4730;
    }
    .waffle-box b{
      font-size:18px;
      color:var(--dark-brown);
      display:block;
      margin-bottom:5px;
    }

    .waffle-box input[type="checkbox"]{display:none;}
    .waffle-box input[type="checkbox"] + label{
      background:#f7f7f7;
      padding:8px 15px;
      border-radius:20px;
      border:1px solid #ddd;
      display:inline-block;
      margin-left:5px;
      margin-bottom:10px;
      cursor:pointer;
      transition:.2s;
      font-size:15px;
      font-weight:500;
    }
    .waffle-box input[type="checkbox"]:checked + label{
      background:var(--waffle-color);
      color:#fff;
      border-color:var(--waffle-color);
      box-shadow:0 2px 4px #0003;
      transform:scale(1.05);
    }

    .topping-group{
      margin:15px 0;
      font-weight:400;
      border-top:1px dashed #ff9f4760;
      padding-top:10px;
    }
    .topping-group:first-child{border-top:none;padding-top:0;}

    .payment-selection-group{margin-top:10px;}
    .payment-selection-group input[type="radio"]{display:none;}
    .payment-selection-group input[type="radio"] + label{
      background:#f7f7f7;
      padding:10px 18px;
      border-radius:25px;
      border:1px solid #ddd;
      display:inline-block;
      margin-left:10px;
      margin-bottom:10px;
      cursor:pointer;
      transition:.2s;
      font-size:16px;
      font-weight:500;
    }
    .payment-selection-group input[type="radio"]:checked + label{
      background:var(--waffle-color);
      color:#fff;
      border-color:var(--waffle-color);
      box-shadow:0 2px 4px #0003;
      transform:scale(1.05);
    }

    .btn{
      width:100%;
      background:var(--waffle-color);
      padding:16px;
      border-radius:10px;
      color:#fff;
      font-weight:700;
      font-size:19px;
      border:none;
      margin-top:30px;
      cursor:pointer;
      box-shadow:0 4px 6px rgba(255,159,71,.4);
      transition:.2s;
    }
    .btn.secondary{
      background:#ccc;
      margin-top:10px;
      color:#222;
      box-shadow:none;
    }

    .btn.pay{
      margin-top:10px;
      font-size:16px;
      padding:12px;
      font-weight:700;
    }
    .btn.pay.bit{background:#2b5cff;}
    .btn.pay.paybox{background:#00bfa5;}

    .total-display{
      margin-top:15px;
      font-weight:700;
      font-size:22px;
      padding:10px;
      border-radius:8px;
      background:#fff3e6;
      color:var(--dark-brown);
      text-align:center;
    }

    .payment-section-hidden{display:none !important;}

    /* âœ… ×ª×™×§×•×Ÿ ×¢×™×¦×•×‘: ×”×‘×œ×•×§ ×¢×¦××• ×œ× FLEX. ×¨×§ ×”×©×•×¨×” ×‘×¤× ×™× */
    .payment-info{
      background:#fff3c4;
      padding:12px;
      border-radius:10px;
      margin-top:10px;
      display:none;            /* × ×©××¨ ××•×¡×ª×¨ ×¢×“ ×‘×—×™×¨×” */
      font-weight:700;
      color:#d67a00;
      border-left:5px solid var(--waffle-color);
    }
    .payment-row{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      flex-wrap:wrap;
    }
    .payment-text{
      flex:1;
      min-width:180px;
    }

    .copy-btn{
      background:#f0f0f0;
      border:1px solid #ccc;
      color:#333;
      padding:7px 12px;
      border-radius:8px;
      font-size:14px;
      font-weight:700;
      cursor:pointer;
      transition:.1s;
      flex-shrink:0;
    }
    .copy-btn:hover{background:#e1e1e1;}
    .copy-btn.copied{
      background:#4CAF50;
      border-color:#4CAF50;
      color:#fff;
    }

    .required-star{color:red;font-size:14px;margin-right:5px;}
    .error-border{border:2px solid red !important;}
    .error-text{color:red;font-size:12px;margin-top:-5px;display:none;}

    .receipt-box{
      display:none;
      margin-top:12px;
      background:#eafff0;
      border:1px solid #b8f3cc;
      padding:10px;
      border-radius:10px;
      font-weight:700;
      text-align:center;
    }
    .receipt-box a{
      display:inline-block;
      margin-top:8px;
      background:#25D366;
      color:#fff;
      padding:10px 12px;
      border-radius:10px;
      text-decoration:none;
    }

    .site-note{
      margin-top:25px;
      padding-top:15px;
      border-top:2px dashed #ff9f4760;
      text-align:center;
      font-weight:700;
      color:var(--dark-brown);
      font-size:15px;
    }
  </style>
</head>

<body>
<div class="box">
  <div class="title">×•×•×¤×œ ×‘×œ×’×™ ×¢×œ ××§×œ ğŸ§‡</div>
  <div class="price">××—×™×¨ ×‘×¡×™×¡: 7 ×©"×— ×œ×•×•×¤×œ</div>

  <div class="phone-link-container">
    <a href="tel:972542296540" class="phone-link">ğŸ“ ×”×ª×§×©×¨×• ××œ×™× ×•: 054-2296540</a>
  </div>

  <label for="name">×©×: <span class="required-star">*</span></label>
  <input id="name" required>
  <div id="error-name" class="error-text">×©×“×” ×—×•×‘×”</div>

  <label for="phone">×˜×œ×¤×•×Ÿ: <span class="required-star">*</span></label>
  <input id="phone" type="tel" required>
  <div id="error-phone" class="error-text">×©×“×” ×—×•×‘×”</div>

  <label for="time">×©×¢×” ×¨×¦×•×™×” ×œ××™×¡×•×£:</label>
  <input id="time" type="time">

  <hr style="margin:25px 0;border:0;border-top:2px dashed #ff9f4760;">

  <label for="qty">×›××•×ª ×•×•×¤×œ×™×:</label>
  <input id="qty" type="number" min="0" value="0">
  <div id="error-qty" class="error-text">×× ×”×›××•×ª 0, ×™×© ×œ××œ× ×”×¢×¨×•×ª ×›×œ×œ×™×•×ª.</div>

  <div id="total" class="total-display">×¡×”"×›: 0 ×©"×—</div>

  <div id="waffles"></div>

  <div id="payment-section" class="payment-options-container payment-section-hidden">
    <label>×××¦×¢×™ ×ª×©×œ×•×: <span class="required-star">*</span></label>

    <div id="payment-options" class="payment-selection-group">
      <input type="radio" name="pay" value="×‘×™×˜" id="pay_bit"><label for="pay_bit"> ğŸ“² ×‘×™×˜</label>
      <input type="radio" name="pay" value="×¤×™×™×‘×•×§×¡" id="pay_fb"><label for="pay_fb"> ğŸ“± ×¤×™×™×‘×•×§×¡</label>
      <input type="radio" name="pay" value="××–×•××Ÿ" id="pay_cash"><label for="pay_cash"> ğŸ’µ ××–×•××Ÿ</label>
    </div>
    <div id="error-pay" class="error-text">× × ×œ×‘×—×•×¨ ×××¦×¢×™ ×ª×©×œ×•×</div>

    <div id="paymentInfo" class="payment-info"></div>

    <button id="openPayBtn" class="btn pay" style="display:none;" type="button">×¤×ª×— ×œ×ª×©×œ×•×</button>

    <div id="paymentUploadInfo" style="display:none;margin-top:10px;font-weight:700;color:var(--dark-brown);">
      ×—×©×•×‘: ××—×¨×™ ×”×ª×©×œ×•×, ×—×–×•×¨ ×œ×©×™×—×” ×•×¦×¨×£ ×¦×™×œ×•× ××¡×š/×§×‘×œ×” ×‘×•×•×˜×¡××¤.
    </div>
  </div>

  <label for="notes">×”×¢×¨×•×ª (×—×•×‘×” ×œ××œ× ×× ×”×›××•×ª 0):</label>
  <textarea id="notes" placeholder="×›××Ÿ × ×™×ª×Ÿ ×œ×”×•×¡×™×£ ×”×¢×¨×•×ª ×›×œ×œ×™×•×ª ×œ×”×–×× ×”..."></textarea>

  <button id="sendBtn" class="btn" onclick="sendUnifiedOrder()">×©×œ×™×—×ª ×”×–×× ×” ×œ×•×•××˜×¡××¤</button>
  <button class="btn secondary" type="button" onclick="resetForm()">××™×¤×•×¡ ×˜×•×¤×¡</button>

  <div id="receiptBox" class="receipt-box">
    ×›×“×™ ×œ×©×œ×•×— ×§×‘×œ×” ×œ×œ×§×•×— ×œ×—×¥ ×›××Ÿ:
    <br>
    <a id="receiptLink" href="#" target="_blank">×©×œ×— ×§×‘×œ×” ×œ×œ×§×•×—</a>
  </div>

  <div class="site-note">
    â­ ×›×“×™ ×©×”×”×–×× ×” ×ª×™×§×œ×˜ â€“ ×—×™×™×‘×™× ×œ×¡×™×™× ××ª ×”×©×œ×™×—×” ×‘×•×•×˜×¡××¤ (×œ×œ×—×•×¥ ×¢×œ â€œ×©×œ×—â€)
  </div>
</div>

<script>
const PRICE = 7;
const MY_PHONE_NUMBER = "972542296540";
const BIT_NUMBER = "0506205953";
const PAYBOX_NUMBER = "0542296540";

function toWaNumber(phone) {
  let d = (phone || "").replace(/\D/g, "");
  if (d.startsWith("972")) return d;
  if (d.startsWith("0")) return "972" + d.slice(1);
  if (d.length === 9 && d.startsWith("5")) return "972" + d;
  return d;
}

function generateOrderId() {
  const now = new Date();
  const datePart = now.getFullYear().toString().slice(2) +
    (now.getMonth() + 1).toString().padStart(2, '0') +
    now.getDate().toString().padStart(2, '0');
  const timePart = now.getHours().toString().padStart(2, '0') +
    now.getMinutes().toString().padStart(2, '0') +
    now.getSeconds().toString().padStart(2, '0');
  return `WAFFLE-${datePart}-${timePart}`;
}

function waLink(phoneNumber, text) {
  return `https://wa.me/${phoneNumber}?text=${encodeURIComponent(text)}`;
}

function openBitPayment(){ window.location.href = "bit://"; }
function openPayBoxPayment(){ window.location.href = "paybox://"; }

async function copyToClipboard(textToCopy, btnElement) {
  try {
    await navigator.clipboard.writeText(textToCopy);
    const original = btnElement.innerText;
    btnElement.innerText = "âœ… ×”×•×¢×ª×§!";
    btnElement.classList.add('copied');
    setTimeout(() => {
      btnElement.innerText = original;
      btnElement.classList.remove('copied');
    }, 1400);
  } catch (err) {
    alert("×”×¢×ª×§×” × ×›×©×œ×”. ×× × ×”×¢×ª×§ ×™×“× ×™×ª: " + textToCopy);
  }
}

function updateWaffles() {
  const qtyInput = document.getElementById("qty");
  let qty = Number(qtyInput.value);
  const paymentSection = document.getElementById("payment-section");
  const paymentInfo = document.getElementById("paymentInfo");
  const openBtn = document.getElementById("openPayBtn");
  const uploadBox = document.getElementById("paymentUploadInfo");

  if (qty < 0 || isNaN(qty)) { qty = 0; qtyInput.value = 0; }

  document.getElementById("total").innerText = `×¡×”"×›: ${qty * PRICE} ×©"×—`;

  if (qty > 0) {
    paymentSection.classList.remove("payment-section-hidden");
  } else {
    paymentSection.classList.add("payment-section-hidden");
    paymentInfo.style.display = "none";
    paymentInfo.innerHTML = "";
    uploadBox.style.display = "none";
    openBtn.style.display = "none";
    document.querySelectorAll('input[name="pay"]').forEach(radio => radio.checked = false);
  }

  let html = "";
  for (let i = 1; i <= qty; i++) {
    html += `
      <div class="waffle-box">
        <b>ğŸ§‡ ×•×•×¤×œ #${i}</b>

        <div class="topping-group">
          <label>×¨×˜×‘×™×:</label>
          <input type="checkbox" id="sauce_choc_${i}" name="sauce_${i}" value="×©×•×§×•×œ×“"><label for="sauce_choc_${i}">ğŸ« ×©×•×§×•×œ×“</label>
          <input type="checkbox" id="sauce_maple_${i}" name="sauce_${i}" value="××™×™×¤×œ"><label for="sauce_maple_${i}">ğŸ¥ ××™×™×¤×œ</label>
          <input type="checkbox" id="sauce_milk_${i}" name="sauce_${i}" value="×¨×™×‘×ª ×—×œ×‘"><label for="sauce_milk_${i}">ğŸ¥› ×¨×™×‘×ª ×—×œ×‘</label>
        </div>

        <div class="topping-group">
          <label>×ª×•×¡×¤×•×ª:</label>
          <input type="checkbox" id="top_oreo_${i}" name="top_${i}" value="××•×¨××•"><label for="top_oreo_${i}">âš« ××•×¨××•</label>
          <input type="checkbox" id="top_lotus_${i}" name="top_${i}" value="×œ×•×˜×•×¡"><label for="top_lotus_${i}">ğŸª ×œ×•×˜×•×¡</label>
          <input type="checkbox" id="top_click_${i}" name="top_${i}" value="×§×œ×™×§"><label for="top_click_${i}">âœ¨ ×§×œ×™×§</label>
          <input type="checkbox" id="top_lentils_${i}" name="top_${i}" value="×¢×“×©×™×"><label for="top_lentils_${i}">ğŸŸ¢ ×¢×“×©×™×</label>
        </div>

        <div class="topping-group">
          <label>××¢×œ:</label>
          <input type="checkbox" id="extra_cream_${i}" name="extra_${i}" value="×§×¦×¤×ª"><label for="extra_cream_${i}">ğŸ¦ ×§×¦×¤×ª</label>
          <input type="checkbox" id="extra_sug_${i}" name="extra_${i}" value="×¡×•×›×¨×™×•×ª"><label for="extra_sug_${i}">ğŸ¬ ×¡×•×›×¨×™×•×ª</label>
        </div>
      </div>
    `;
  }
  document.getElementById("waffles").innerHTML = html;
}

document.getElementById("qty").addEventListener("input", updateWaffles);
document.addEventListener("DOMContentLoaded", updateWaffles);

function resetForm() {
  if (confirm("×”×× ××ª×” ×‘×˜×•×— ×©×‘×¨×¦×•× ×š ×œ××¤×¡ ××ª ×›×œ ×¤×¨×˜×™ ×”×˜×•×¤×¡?")) {
    document.getElementById("name").value = "";
    document.getElementById("phone").value = "";
    document.getElementById("time").value = "";
    document.getElementById("qty").value = 0;
    document.getElementById("notes").value = "";

    document.querySelectorAll('input[name="pay"]').forEach(r => r.checked = false);

    document.getElementById("paymentInfo").style.display = "none";
    document.getElementById("paymentInfo").innerHTML = "";
    document.getElementById("paymentUploadInfo").style.display = "none";
    document.getElementById("openPayBtn").style.display = "none";
    document.getElementById("receiptBox").style.display = "none";

    document.querySelectorAll('.error-text').forEach(el => el.style.display = "none");
    document.querySelectorAll('input, textarea, #payment-options').forEach(el => el.classList.remove("error-border"));

    updateWaffles();
  }
}

function validateField(id, errorTextId, validationFn, errorMessage) {
  const input = document.getElementById(id);
  const errorEl = document.getElementById(errorTextId);
  const ok = validationFn(input.value);

  if (!ok) {
    input.classList.add("error-border");
    errorEl.innerText = errorMessage;
    errorEl.style.display = "block";
  } else {
    input.classList.remove("error-border");
    errorEl.style.display = "none";
  }
  return ok;
}

function sendUnifiedOrder() {
  const sendBtn = document.getElementById('sendBtn');
  if (sendBtn.disabled) return;

  const name = document.getElementById("name").value.trim();
  const phone = document.getElementById("phone").value.trim();
  const time = document.getElementById("time").value.trim();
  const pay = document.querySelector('input[name="pay"]:checked');
  const qty = Number(document.getElementById("qty").value);
  const notes = document.getElementById("notes").value.trim();

  let isFormValid = true;

  if (!validateField("name", "error-name", v => v.length > 0, "× × ×œ××œ× ××ª ×”×©×.")) isFormValid = false;
  if (!validateField("phone", "error-phone", v => v.replace(/\D/g, "").length >= 7, "× × ×œ××œ× ×˜×œ×¤×•×Ÿ ×ª×§×™×Ÿ (××™× ×™××•× 7 ×¡×¤×¨×•×ª).")) isFormValid = false;

  if (qty === 0 && notes.length === 0) {
    document.getElementById("qty").classList.add("error-border");
    document.getElementById("error-qty").innerText = "×× ×”×›××•×ª 0, ×™×© ×œ××œ× ×”×¢×¨×•×ª ×›×œ×œ×™×•×ª (×œ××©×œ, ×œ×ª×™××•× ×©×¢×”/×‘×™×¨×•×¨).";
    document.getElementById("error-qty").style.display = "block";
    document.getElementById("notes").classList.add("error-border");
    isFormValid = false;
  } else {
    document.getElementById("qty").classList.remove("error-border");
    document.getElementById("error-qty").style.display = "none";
    document.getElementById("notes").classList.remove("error-border");
  }

  const errorPayEl = document.getElementById("error-pay");
  const paymentOptionsEl = document.getElementById("payment-options");
  if (qty > 0 && !pay) {
    paymentOptionsEl.classList.add("error-border");
    errorPayEl.style.display = "block";
    isFormValid = false;
  } else {
    paymentOptionsEl.classList.remove("error-border");
    errorPayEl.style.display = "none";
  }

  if (!isFormValid) {
    alert("× × ×œ×ª×§×Ÿ ××ª ×”×©×“×•×ª ×”××¡×•×× ×™× ×‘××“×•× ×œ×¤× ×™ ×”×©×œ×™×—×”.");
    return;
  }

  sendBtn.disabled = true;
  sendBtn.innerText = "×¤×•×ª×— ×•×•×˜×¡××¤...";

  const orderId = generateOrderId();
  const totalPrice = qty * PRICE;
  const paymentStatus = pay ? pay.value : '×œ× ×¨×œ×•×•× ×˜×™ (×›××•×ª 0)';

  const orderDetails = {
    orderId,
    customerName: name,
    customerPhone: phone,
    pickupTime: time || '×œ× ×¦×•×™×Ÿ',
    quantity: qty,
    totalPrice,
    paymentMethod: paymentStatus,
    notes,
    waffles: []
  };

  for (let i = 1; i <= qty; i++) {
    const sauces = [...document.querySelectorAll(`input[name="sauce_${i}"]:checked`)].map(x => x.value);
    const tops   = [...document.querySelectorAll(`input[name="top_${i}"]:checked`)].map(x => x.value);
    const extras = [...document.querySelectorAll(`input[name="extra_${i}"]:checked`)].map(x => x.value);

    orderDetails.waffles.push({
      id: i,
      sauces: sauces.join(", ") || "×œ×œ× ×¨×˜×‘×™×",
      toppings: tops.join(", ") || "×œ×œ× ×ª×•×¡×¤×•×ª",
      extras: extras.join(", ") || "×œ×œ× ×¤×™× ×™×©"
    });
  }

  // âœ… ×”×•×“×¢×” ×œ××¨×›×– ×”×”×–×× ×•×ª (×‘×œ×™ "×¡×™×›×•× ×œ××˜×‘×—" ×•×‘×œ×™ ×‘×œ×•×§ ×”×¢×ª×§×”)
  let orderMsg =
    `[ORDER_ID: ${orderDetails.orderId}]\n` +
    `*ğŸ”” ×”×–×× ×” ×—×“×©×” (×•×•×¤×œ ×‘×œ×’×™) ğŸ””*\n` +
    "==============================\n" +
    `*×§×•×“ ×”×–×× ×”*: ${orderDetails.orderId}\n` +
    `*×¤×¨×˜×™ ×œ×§×•×—:*\n` +
    `*×©×*: ${orderDetails.customerName}\n` +
    `*×˜×œ×¤×•×Ÿ*: ${orderDetails.customerPhone}\n` +
    `*×©×¢×” ×¨×¦×•×™×” ×œ××™×¡×•×£*: ${orderDetails.pickupTime}\n` +
    `*×›××•×ª*: ${orderDetails.quantity}\n` +
    `*×¡×”\"×› ×œ×ª×©×œ×•×*: ${orderDetails.totalPrice} ×©\"×—\n` +
    `*×××¦×¢×™ ×ª×©×œ×•×*: ${orderDetails.paymentMethod}\n` +
    "==============================\n" +
    "*×¤×™×¨×•×˜ ×”×”×–×× ×”:*\n";

  if (orderDetails.quantity === 0) {
    orderMsg += `*××™×Ÿ ×•×•×¤×œ×™× ×‘×”×–×× ×” ×–×•.* (×¤× ×™×™×” ×›×œ×œ×™×ª).\n`;
  } else {
    orderDetails.waffles.forEach(w => {
      orderMsg +=
        `\n*×•×•×¤×œ #${w.id}*:\n` +
        `×¨×˜×‘×™×: ${w.sauces}\n` +
        `×ª×•×¡×¤×•×ª: ${w.toppings}\n` +
        `×¤×™× ×™×©: ${w.extras}\n`;
    });
  }

  if (orderDetails.notes) orderMsg += `\n*×”×¢×¨×•×ª ×›×œ×œ×™×•×ª*: ${orderDetails.notes}\n`;

  orderMsg +=
    "\n==============================\n" +
    `${pay && pay.value !== "××–×•××Ÿ" ? 'ğŸ”´ *×”×¢×¨×” ×œ×ª×©×œ×•×:* ×”×œ×§×•×— ××ª×‘×§×© ×œ×¦×¨×£ ××™×©×•×¨ ×ª×©×œ×•×.\n' : ''}`;

  window.open(waLink(MY_PHONE_NUMBER, orderMsg), "_blank");

  // ×§×‘×œ×” ×œ×œ×§×•×—
  const customerWa = toWaNumber(orderDetails.customerPhone);
  let receiptMsg =
    `âœ… ×§×‘×œ×” - ×•×•×¤×œ ×‘×œ×’×™ ×¢×œ ××§×œ\n\n` +
    `*×§×•×“ ×”×–×× ×”*: ${orderDetails.orderId}\n` +
    `*×¡×”\"×›*: ${orderDetails.totalPrice} ×©\"×—\n` +
    `*×××¦×¢×™ ×ª×©×œ×•×*: ${orderDetails.paymentMethod}\n` +
    `*×©×¢×”*: ${orderDetails.pickupTime}\n\n` +
    `*×¤×™×¨×•×˜:*\n`;

  if (orderDetails.quantity === 0) {
    receiptMsg += `××™×Ÿ ×¤×™×¨×•×˜ ×•×•×¤×œ×™× (×¤× ×™×™×” ×›×œ×œ×™×ª).\n`;
  } else {
    receiptMsg += orderDetails.waffles.map(w =>
      `\n*×•×•×¤×œ #${w.id}*\n` +
      `×¨×˜×‘×™×: ${w.sauces}\n` +
      `×ª×•×¡×¤×•×ª: ${w.toppings}\n` +
      `×¤×™× ×™×©: ${w.extras}\n`
    ).join("");
  }

  document.getElementById("receiptLink").href = waLink(customerWa, receiptMsg);
  document.getElementById("receiptBox").style.display = "block";

  setTimeout(() => {
    sendBtn.disabled = false;
    sendBtn.innerText = "×©×œ×™×—×ª ×”×–×× ×” ×œ×•×•××˜×¡××¤";
  }, 1200);
}

// âœ… ×ª×©×œ×•× + ×¤×ª×™×—×” + ×”×¢×ª×§×” (×‘×œ×™ ×œ×©×‘×•×¨ ×¢×™×¦×•×‘)
document.querySelectorAll('input[name="pay"]').forEach(r => {
  r.addEventListener("change", () => {
    const val = r.value;

    const infoBox = document.getElementById("paymentInfo");
    const uploadBox = document.getElementById("paymentUploadInfo");
    const openBtn = document.getElementById("openPayBtn");

    if (val === "×‘×™×˜") {
      infoBox.innerHTML = `
        <div class="payment-row">
          <div class="payment-text">ğŸ“² ××¡×¤×¨ ×œ×ª×©×œ×•× ×‘×‘×™×˜: <span style="margin-right:10px;">050-6205953</span></div>
          <button type="button" class="copy-btn" onclick="copyToClipboard('${BIT_NUMBER}', this)">×”×¢×ª×§</button>
        </div>
      `;
      infoBox.style.display = "block";

      openBtn.style.display = "block";
      openBtn.className = "btn pay bit";
      openBtn.innerText = "×¤×ª×— ×‘×™×˜ ×œ×ª×©×œ×•×";
      openBtn.onclick = openBitPayment;

      uploadBox.style.display = "block";
    }

    else if (val === "×¤×™×™×‘×•×§×¡") {
      infoBox.innerHTML = `
        <div class="payment-row">
          <div class="payment-text">ğŸ“² ××¡×¤×¨ ×œ×ª×©×œ×•× ×‘×¤×™×™×‘×•×§×¡: <span style="margin-right:10px;">054-2296540</span></div>
          <button type="button" class="copy-btn" onclick="copyToClipboard('${PAYBOX_NUMBER}', this)">×”×¢×ª×§</button>
        </div>
      `;
      infoBox.style.display = "block";

      openBtn.style.display = "block";
      openBtn.className = "btn pay paybox";
      openBtn.innerText = "×¤×ª×— ×¤×™×™×‘×•×§×¡ ×œ×ª×©×œ×•×";
      openBtn.onclick = openPayBoxPayment;

      uploadBox.style.display = "block";
    }

    else if (val === "××–×•××Ÿ") {
      infoBox.innerHTML = `<div>ğŸ’µ ×ª×©×œ×•× ××¦×œ ××©×¤×—×ª ×˜×™ (×‘××™×¡×•×£)</div>`;
      infoBox.style.display = "block";

      openBtn.style.display = "none";
      uploadBox.style.display = "none";
    }
  });
});
</script>
</body>
</html>
